generator skillsClient {
  provider = "prisma-client-js"
  // Generate a package-scoped client to avoid monorepo conflicts
  output   = "./generated/skills-client"
}

datasource skillsDb {
  provider = "postgresql"
  url      = env("SKILLS_DB_URL")
  schemas  = ["skills"]
}

// Standardized Skills models (mapped to standardized-skills-api tables)
model SkillCategory {
  id          String   @id @default(uuid())
  name        String
  description String?
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  skills      Skill[]

  @@unique([name], map: "uniq_category_name")
  @@map("skill_category")
  @@schema("skills")
}

model Skill {
  id          String    @id @default(uuid())
  name        String
  description String?
  categoryId  String?   @map("category_id")
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")
  deletedAt   DateTime? @map("deleted_at")

  category   SkillCategory? @relation(fields: [categoryId], references: [id])
  userSkills UserSkill[]

  @@unique([name], map: "uniq_skill_name")
  @@index([categoryId], map: "fki_fk_skill_category")
  @@map("skill")
  @@schema("skills")
}

model UserSkillLevel {
  id          String      @id @default(uuid())
  name        String
  description String?
  createdAt   DateTime    @default(now()) @map("created_at")
  updatedAt   DateTime    @updatedAt @map("updated_at")
  userSkills  UserSkill[]

  @@unique([name], map: "uniq_skill_level_name")
  @@map("user_skill_level")
  @@schema("skills")
}

model UserSkillDisplayMode {
  id          String      @id
  name        String
  description String?
  createdAt   DateTime    @default(now()) @map("created_at")
  updatedAt   DateTime    @updatedAt @map("updated_at")
  userSkills  UserSkill[]

  @@unique([name], map: "user_skill_display_mode_name_key")
  @@map("user_skill_display_mode")
  @@schema("skills")
}

model UserSkill {
  id                     String   @id @default(uuid())
  userId                 Int      @map("user_id")
  skillId                String   @map("skill_id")
  userSkillLevelId       String   @map("user_skill_level_id")
  userSkillDisplayModeId String   @map("user_skill_display_mode_id")
  createdAt              DateTime @default(now()) @map("created_at")
  updatedAt              DateTime @updatedAt @map("updated_at")

  skill                Skill                @relation(fields: [skillId], references: [id])
  userSkillLevel       UserSkillLevel       @relation(fields: [userSkillLevelId], references: [id])
  userSkillDisplayMode UserSkillDisplayMode @relation(fields: [userSkillDisplayModeId], references: [id])

  @@unique([userId, skillId, userSkillLevelId], map: "uniq_user_skill_type")
  @@index([skillId], map: "fki_fk_skill")
  @@index([userSkillLevelId], map: "fki_fk_user_skill_level")
  @@index([userSkillDisplayModeId], map: "fki_fk_user_skill_display_mode")
  @@map("user_skill")
  @@schema("skills")
}
